version: "3.7"

services:
  influx:
    build: docker/influx
    image: influx
    ports:
      - "8086:8086"

  pgdb:
    build: docker/postgres
    image: pgdb
    ports:
      - "5432:5432"
    environment:
      - POSTGRES_PASSWORD=pg_password

  shell:
    build: docker/shell
    image: shell
    volumes:
      - ./consumer:/consumer
      - ./producer:/producer
    environment:
      - INFLUX_ORG=llvinin00@gmail.com
      - INFLUX_BUCKET=hydrograph_time_series
      - INFLUX_TOKEN=AFc9TbNnbrJ8x0marY-9MMlDWTYZEYWXdjr8oiWK1qZzHyxawpPmx-67ZD2_wdNsqJF-6dfpq7_Lt2WFqJPe0A==

  pg_client:
    depends_on:
      - pgdb
    build: docker/pg_client
    image: pg_client
    volumes:
      - ./pg_commands:/commands
